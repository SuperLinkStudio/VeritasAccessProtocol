# 信息加密传输要求

Veritas Access Protocol 中定义了需要实施加密与签名的数据内容。

作为专门用于管理访问令牌使用阶段的安全协议，本协议**不会强制规定**具体加密、签名方案。此设计旨在为认证服务器与客户端提供更高的灵活性，使其能够不断更新并采用更高安全级别的加密与签名机制。

作为最低安全要求，应至少采用 **X25519** 算法和 **Ed25519** 算法的组合方案。

具体的加密算法、密钥分配、密钥轮换等流程由**认证服务器**规定。

## 字段加密格式示例

在[核心操作流程](./Core.md#核心操作流程)中，以 `tdt` 为例，对于加密字段的解释会添加一段标识，如下:

| 字段             | 解释                                                |
| ---------------- | --------------------------------------------------- |
| ……               | ……                                                  |
| `tdt`            | (由**客户端**加密) TDT 值                           |
| `<被加密的字段>` | (由`<执行加密的一方>`加密并签名) `<对于字段的解释>` |
| ……               | ……                                                  |

加密字段必须封装为 JSON 对象，其结构如下:

```json
// 示例结构，实际内容取决于所选用的加密算法以及认证服务器要求
"<被加密的字段>": {
  "ciphertext": "<密文>",
  "signature": "<签名>"
}
```

在 POST 请求中，包含加密字段的请求体结构示例如下：

```json
{
  "...": "...",
  "tdt": {
    "ciphertext": "<加密数据>",
    "signature": "<签名值>"
  },
  "...": "..."
}
```
